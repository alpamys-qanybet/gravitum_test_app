# gravitum-test-app

### Go

Clone this repository into `$GOPATH/src` directory, by default it is located in `~/go`. Or set `$GOPATH` in your bash profile.

install dependencies:
1. `go mod tidy`
2. `go mod vendor`

run server:
`go run cmd/gravitum-test-app/main.go` or `make run` or `./run-local.sh`

build:
`go build ./cmd/gravitum-test-app` or `make binary`

you can change environment variables in `.env`.
env sample:
```
APP_PROFILE=prod
APP_HOST=localhost
APP_PORT=8080

SECURITY_CORS_ENABLED=true
SECURITY_CORS_ALLOW_ORIGINS=https://myfront-site.kz

DB_HOST=localhost
DB_PORT=5432
DB_NAME=my_db_name
DB_SCHEMA=public
DB_TIMEOUT=10

LOG_LEVEL=debug
```

### Docker
1. `docker compose -f docker-compose.yml up -d` to start containers or `make compose`

2. `docker compose -f docker-compose.yml down` to stop containers or `-v` with deleting volumes option

run `docker ps` to see if dependant db container exists(generated by docker-compose) with port forwarding 5432 of container db into machine 5433(thus you will able to access by localhost:5433 the container db and do not conflict with your machine postgres)

### Unit tests
run `go test -v ./...` or `make test` in root folder, make sure that you have running docker db container

### Makefile
run `make compose` docker compose starting containers

run `make run` local development

run `make binary` generates golang binary

run `make test` for tests

### Browser
`http://localhost:3001` for docker

`http://localhost:8080` for local development

why? Probably because port 8080 is in use, it is popular port, the same goes to postgres 5433 instead of standart 5432, the main reason is to use probably free port.